<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>QRForge Pro</title>
<style>
:root{
    --bg:#0d0d0d;
    --card:#1a1a1a;
    --text:white;
    --input:#2b2b2b;
    --accent:#00c4ff;
}
[data-theme="light"]{
    --bg:#f2f2f2;
    --card:#fff;
    --text:#111;
    --input:#e5e5e5;
    --accent:#007acc;
}
body{
    margin:0;
    font-family:Arial,sans-serif;
    background:var(--bg);
    color:var(--text);
}
.card{
    background:var(--card);
    border-radius:15px;
    padding:20px;
    max-width:400px;
    margin:15px auto;
    box-shadow:0 0 15px rgba(0,0,0,0.4);
}
input,select,button{
    width:100%;
    padding:12px;
    margin-top:10px;
    border-radius:10px;
    border:none;
    font-size:16px;
}
input,select{
    background:var(--input);
    color:var(--text);
}
button{
    background:var(--accent);
    color:black;
    font-weight:bold;
    cursor:pointer;
}
button:active{
    transform:scale(0.97);
}
.topbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:10px 20px;
    background:var(--card);
}
.bottomNav{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    display:flex;
    justify-content:space-around;
    background:var(--card);
    padding:10px 0;
    border-top:1px solid #333;
}
.navBtn{
    cursor:pointer;
    padding:6px 12px;
    border-radius:10px;
}
.navActive{
    background:var(--accent);
    color:black;
}
#qrcode{
    background:white;
    padding:10px;
    margin:10px auto;
    border-radius:10px;
    width:fit-content;
}
.historyItem{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:8px;
    margin:8px 0;
    border-radius:10px;
    background:var(--input);
}
.historyItem img{
    width:50px;
    height:50px;
    margin-left:10px;
}
</style>
</head>
<body data-theme="dark">

<!-- LOGIN PAGE -->
<div id="loginPage" class="card" style="margin-top:50px;">
<h2>Connexion</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Mot de passe">
<button onclick="login()">Se connecter</button>
</div>

<!-- APP PAGE -->
<div id="appPage" style="display:none;">
<div class="topbar">
<h2>QRForge</h2>
<button onclick="logout()">Déconnexion</button>
</div>

<div class="card">
<label>Nom du QR (obligatoire)</label>
<input type="text" id="qrName" placeholder="Ex: Mon QR perso">
<label>Texte / Lien</label>
<input type="text" id="text" placeholder="Tape ici…">
<label>Couleur du QR</label>
<input type="color" id="color" value="#000000">
<label>Taille</label>
<select id="size">
<option value="150">150px</option>
<option value="200" selected>200px</option>
<option value="250">250px</option>
<option value="300">300px</option>
</select>
<div id="qrcode"></div>
<button id="downloadBtn">Télécharger QR</button>
</div>
</div>

<!-- HISTORIQUE PAGE -->
<div id="historyPage" style="display:none;">
<div class="topbar">
<h2>Historique</h2>
<button onclick="logout()">Déconnexion</button>
</div>
<div class="card" id="historyList">
<p>Aucun QR généré.</p>
</div>
</div>

<!-- PROFIL PAGE -->
<div id="profilePage" style="display:none;">
<div class="topbar">
<h2>Profil</h2>
<button onclick="logout()">Déconnexion</button>
</div>
<div class="card">
<p><strong>Email :</strong> <span id="userEmail"></span></p>
<label>Thème :</label>
<select id="themeSelect">
<option value="dark">Sombre</option>
<option value="light">Clair</option>
</select>
</div>
</div>

<!-- NAVIGATION -->
<div class="bottomNav">
<div class="navBtn navActive" onclick="switchPage('appPage',this)">QR</div>
<div class="navBtn" onclick="switchPage('historyPage',this)">Historique</div>
<div class="navBtn" onclick="switchPage('profilePage',this)">Profil</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
<script>
// ---------- LOGIN ----------
function login(){
let email=document.getElementById("email").value.trim();
let pass=document.getElementById("password").value.trim();
if(!email||!pass){alert("Remplis tout.");return;}
localStorage.setItem("qr_user",email);
showApp();
}
function logout(){
localStorage.removeItem("qr_user");
location.reload();
}
function showApp(){
document.getElementById("loginPage").style.display="none";
document.getElementById("appPage").style.display="block";
document.getElementById("userEmail").textContent=localStorage.getItem("qr_user");
loadHistory();
}
// ---------- NAV ----------
function switchPage(id,btn){
['appPage','historyPage','profilePage'].forEach(e=>document.getElementById(e).style.display="none");
document.getElementById(id).style.display="block";
document.querySelectorAll('.navBtn').forEach(e=>e.classList.remove('navActive'));
btn.classList.add('navActive');
}
// ---------- THEME ----------
const themeSelect=document.getElementById("themeSelect");
themeSelect.addEventListener("change",()=>document.body.setAttribute("data-theme",themeSelect.value));
// ---------- QR GENERATION ----------
let qrDiv=document.getElementById("qrcode"),qr;
function genererQR(){
let name=document.getElementById("qrName").value.trim();
let txt=document.getElementById("text").value.trim();
let color=document.getElementById("color").value;
let size=document.getElementById("size").value;
if(!txt||!name) return;
qrDiv.innerHTML="";
qr=new QRCode(qrDiv,{text:txt,width:size,height:size,colorDark:color,colorLight:"#fff"});
saveHistory(name,txt,color,size);
}
document.getElementById("text").addEventListener("input",genererQR);
document.getElementById("color").addEventListener("input",genererQR);
document.getElementById("size").addEventListener("change",genererQR);
document.getElementById("qrName").addEventListener("input",genererQR);
// ---------- DOWNLOAD ----------
document.getElementById("downloadBtn").onclick=()=>{
let img=qrDiv.querySelector("img");
if(!img){alert("Génère le QR d'abord!");return;}
let link=document.createElement("a");
link.href=img.src;
link.download=document.getElementById("qrName").value+".png";
link.click();
};
// ---------- HISTORIQUE ----------
function saveHistory(name,txt,color,size){
let history=JSON.parse(localStorage.getItem("qr_history")||"[]");
let timestamp=new Date().toLocaleString();
let entry={name,txt,color,size,timestamp};
history.unshift(entry);
if(history.length>20) history.pop();
localStorage.setItem("qr_history",JSON.stringify(history));
loadHistory();
}
function loadHistory(){
let list=document.getElementById("historyList");
let history=JSON.parse(localStorage.getItem("qr_history")||"[]");
list.innerHTML="";
if(history.length==0){list.innerHTML="<p>Aucun QR généré.</p>";return;}
history.forEach(item=>{
let div=document.createElement("div");
div.className="historyItem";
let qrBox=document.createElement("div");
let qrTemp=document.createElement("div");
new QRCode(qrTemp,{text:item.txt,width:50,height:50,colorDark:item.color,colorLight:"#fff"});
qrBox.appendChild(qrTemp);
div.innerHTML=`<div><strong>${item.name}</strong><br>${item.timestamp}</div>`;
div.appendChild(qrBox);
let dlBtn=document.createElement("button");
dlBtn.textContent="Télécharger";
dlBtn.style.marginLeft="10px";
dlBtn.onclick=()=>{let img=qrTemp.querySelector("img");if(img){let link=document.createElement("a");link.href=img.src;link.download=item.name+".png";link.click();}};
div.appendChild(dlBtn);
list.appendChild(div);
});
}
// ---------- AUTO LOGIN ----------
if(localStorage.getItem("qr_user")) showApp();
</script>
</body>
</html>